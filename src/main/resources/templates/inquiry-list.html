<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>내 문의 목록 - NHN Mart 고객센터</title>
    <!-- 분리된 CSS 파일 연결 -->
    <link rel="stylesheet" th:href="@{/css/inquiry-list.css}">
</head>
<body>
<div class="container clearfix">
    <a th:href="@{/cs/logout}" class="logout-btn">로그아웃</a>

    <h1>내 문의 목록</h1>

    <div th:if="${session.loginUser}" class="welcome-msg">
        <p><strong th:text="${session.loginUser.name}">고객</strong>님, 환영합니다.</p>
    </div>

    <div class="action-buttons">
        <a th:href="@{/cs/inquiry}" class="btn btn-primary">문의하기</a>
    </div>

    <form th:action="@{/cs}" method="get" class="search-form">
        <label for="category-select">분류별 보기:</label>
        <select id="category-select" name="category">
            <option value="">-- 전체 보기 --</option>
            <option th:each="cat : ${categories}"
                    th:value="${cat.name()}"
                    th:text="${cat.description}"
                    th:selected="${cat.name() == selectedCategory}">카테고리</option>
        </select>
        <button type="submit" class="btn btn-secondary">검색</button>
    </form>

    <!-- 문의 목록 테이블 -->
    <h2>문의 내역</h2>
    <table>
        <thead>
        <tr>
            <th>번호</th>
            <th>제목</th>
            <th>분류</th>
            <th>작성일시</th>
            <th>답변 상태</th>
        </tr>
        </thead>
        <tbody>
        <!-- 문의 내역이 없을 경우 메시지 표시 -->
        <tr th:if="${#lists.isEmpty(inquiries)}">
            <td colspan="5" class="no-data">작성하신 문의 내역이 없습니다.</td>
        </tr>
        <!-- 문의 내역 리스트 반복 출력 -->
        <!-- Controller에서 전달받은 inquiries 리스트 사용 -->
        <tr th:each="inquiry, iterStat : ${inquiries}">
            <!-- iterStat.count는 1부터 시작하는 순번 -->
            <td th:text="${iterStat.count}">1</td>
            <td>
                <!-- 제목 클릭 시 상세 페이지로 이동 -->
                <a th:href="@{/cs/inquiry/{id}(id=${inquiry.id})}" th:text="${inquiry.title}">문의 제목</a>
            </td>
            <!-- DTO에 있는 category(String) 필드 사용 -->
            <td th:text="${inquiry.category}">분류</td>
            <!-- DTO에 있는 createdAt(String - 포맷팅된) 필드 사용 -->
            <td th:text="${inquiry.createdAt}">2025-10-24</td>
            <td>
                <!-- DTO에 있는 answered(boolean) 필드 사용 -->
                <span th:if="${inquiry.answered}" class="status answered">답변 완료</span>
                <span th:unless="${inquiry.answered}" class="status pending">답변 대기</span>
            </td>
        </tr>
        </tbody>
    </table>

</div>
</body>
</html>

